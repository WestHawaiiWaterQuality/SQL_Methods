-- create script for Ooma 
-- last update 04/7/2018

USE WHWQ4
-

/*
Marine Environmental Assessment
O’oma Beachside Village North Kona, Hawaii

Marine Community Structure
Prepared for O’oma Beachside Village LLC
Prepared by: S.J. Dollar Marine Research Consultants, Inc 1039 Waakaua Pl. Honolulu, HI 96822
May 2008

TableA2: 10/90,5/91,11/91,3/92
	Stations: 1,5,10,50,10,200

Table A4: 11/1/92
	Stations: 0,5,10,25,50,100,500

Table 2: 11/3/2006
	Stations: 0,1,2,5,10,15,20,30,50,150
 */

/* Ooma Raw Create, read in the entire file as varchar fields, 
   address conversion once into a table */
-- DROP TABLE OOMARawVarChars 
CREATE TABLE OOMARawVarChars (
 oomIID INT NOT NULL IDENTITY(1,1) PRIMARY KEY,
 TableTransect [varchar](255) NULL,
 Transect      [varchar](255) NULL,
 StaCode       [varchar](255) NULL,--name assigned by SJDollar e.g. TABLE2_OOMA_1
 StationNum    [varchar](255) NULL,
 DFS           [varchar](255) NULL,-- distance from shore

 PO436396      [varchar](255) NULL,-- analytes
 Nate6393      [varchar](255) NULL,
 Ammn6220      [varchar](255) NULL,
 Sili6360      [varchar](255) NULL,
 DOgP6368      [varchar](255) NULL,
 DogN6369      [varchar](255) NULL,
 TPho6240      [varchar](255) NULL,
 TDNi6210      [varchar](255) NULL,
 Turb6260      [varchar](255) NULL,
 Sali6350      [varchar](255) NULL,
 ChlA6250      [varchar](255) NULL,
 Temp6280      [varchar](255) NULL,
 OxyS6367      [varchar](255) NULL,
 pHyd6390      [varchar](255) NULL,
 )

 select * from OOMARawVarChars
-- Now do the MS Management Studio Import
-- Flat File into the table above, make sure all varchar on import field mapping
-- all field names and the heading in the orginal file must match exactly (to prevent manual tweaking)
-- bottom line, all field come in as varchar for now, and into this table above
/*
1	TABLE2_OOMA_1	1	1S	1	0	5.27	67.76	7.14	1231	8.37	91.70	13.64	166.60	0.20	32.917	0.69	26.64	106.4	8.25
2	TABLE2_OOMA_1	1	2S	2	1	15.50	125.30	4.76	2105	11.78	111.30	27.28	241.36	0.29	31.482	0.74	26.76	105.3	8.27
3	TABLE2_OOMA_1	1	3S	3	2	3.41	109.34	8.26	1850	9.92	96.04	13.33	213.64	0.21	31.952	0.56	26.89	107.0	8.27
4	TABLE2_OOMA_1	1	4S	4	5	8.37	104.72	5.60	1810	8.37	94.22	16.74	204.54	0.13	31.987	0.91	26.99	107.5	8.27
5	TABLE2_OOMA_1	1	5S	5	10	2.79	94.64	5.04	1792	12.71	114.80	15.50	214.48	0.20	32.048	0.94	27.00	106.4	8.26
6	TABLE2_OOMA_1	1	6S	6	15	1.24	80.36	3.50	1451	8.99	99.26	10.23	183.12	0.14	32.655	0.71	27.01	104.3	8.25
7	TABLE2_OOMA_1	1	7S	7	20	0.93	78.26	5.04	1324	8.68	87.50	9.61	170.80	0.12	32.839	0.63	27.06	104.8	8.24
8	TABLE2_OOMA_1	1	8S	8	30	0.93	56.00	6.16	1091	10.85	92.40	11.78	154.56	0.14	33.147	0.39	27.09	103.5	8.22
9	TABLE2_OOMA_1	1	9S	9	50	0.93	8.12	8.96	199	8.37	80.08	9.30	97.16	0.10	34.548	0.20	27.10	108.1	8.16
10	TABLE2_OOMA_1	1	10S	10	150	0.31	3.08	12.32	70	8.68	96.46	8.99	111.86	0.07	34.727	0.15	27.25	105.1	8.15

11	TABLE2_OOMA_2	2	1S	1	0	0.93	224.56	8.96	2061	8.37	118.86	9.30	352.38	0.78	28.977	1.22	26.89	105.2	8.07
12	TABLE2_OOMA_2	2	2S	2	1	0.93	26.88	7.56	861	9.30	97.86	10.23	132.30	0.18	33.123	0.40	27.01	105.8	8.26
13	TABLE2_OOMA_2	2	3S	3	2	0.93	15.12	8.54	854	9.30	92.82	10.23	116.48	0.18	33.064	0.87	27.01	104.6	8.33
14	TABLE2_OOMA_2	2	4S	4	5	0.93	25.48	6.02	858	8.99	104.86	9.92	136.36	0.14	33.205	0.28	27.04	106.3	8.24
15	TABLE2_OOMA_2	2	5S	5	10	0.93	7.56	8.68	401	8.68	89.18	9.61	105.42	0.11	34.081	0.34	27.10	104.5	8.23
16	TABLE2_OOMA_2	2	6S	6	15	0.93	5.74	10.78	325	8.68	83.58	9.61	100.10	0.10	34.233	0.73	27.13	105.5	8.22
17	TABLE2_OOMA_2	2	7S	7	20	0.62	2.52	10.50	249	8.06	91.00	8.68	104.02	0.08	34.408	0.28	27.19	106.4	8.21
18	TABLE2_OOMA_2	2	8S	8	30	0.62	2.94	10.78	205	8.68	99.96	9.30	113.68	0.09	34.521	0.34	27.20	101.2	8.18
19	TABLE2_OOMA_2	2	9S	9	50	0.62	2.66	7.28	168	8.37	96.60	8.99	106.54	0.08	34.605	0.38	27.23	104.5	8.18
20	TABLE2_OOMA_2	2	10S	10	150	1.55	1.96	5.18	74	8.99	81.34	10.54	88.48	0.08	34.729	0.12	27.24	105.5	8.16

21	TABLE2_OOMA_3	3	1S	1	0	19.53	642.18	14.14	10342	6.51	59.36	26.04	715.68	0.13	17.149	0.44	26.54	107.4	8.18
22	TABLE2_OOMA_3	3	2S	2	1	1.24	159.04	17.36	3051	9.92	147.56	11.16	323.96	0.15	28.751	0.27	26.99	105.5	8.28
23	TABLE2_OOMA_3	3	3S	3	2	0.62	124.04	15.68	3024	10.85	130.90	11.47	270.62	0.22	29.265	2.00	27.01	104.8	8.31
24	TABLE2_OOMA_3	3	4S	4	5	0.93	116.90	9.94	2838	9.30	106.12	10.23	232.96	0.15	29.642	0.64	27.21	106.3	8.32
25	TABLE2_OOMA_3	3	5S	5	10	1.86	118.02	9.10	2872	7.75	116.62	9.61	243.74	0.13	29.618	0.46	27.14	105.3	8.32
26	TABLE2_OOMA_3	3	6S	6	15	1.24	77.70	1.96	2220	8.68	128.38	9.92	208.04	0.13	30.853	0.46	27.15	108.4	8.34
27	TABLE2_OOMA_3	3	7S	7	20	1.86	25.76	0.84	926	8.68	101.92	10.54	128.52	0.10	33.332	0.39	27.21	103.1	8.29
28	TABLE2_OOMA_3	3	8S	8	30	2.79	21.00	3.08	698	8.37	90.02	11.16	114.10	0.09	33.777	0.45	27.22	104.3	8.26
29	TABLE2_OOMA_3	3	9S	9	50	11.47	4.76	0.98	185	0.62	105.00	12.09	110.74	0.09	34.595	0.22	27.27	108.8	8.19
30	TABLE2_OOMA_3	3	10S	10	150	1.86	6.30	1.12	189	7.44	105.56	9.30	112.98	0.07	34.575	0.13	27.25	105.8	8.14
-- different transect, a bit North near a bathhouse
31	TABLEA2_OOMA_1	1	1S	1	1	73.78	1076.94	0.83	14299.72	1.58	68.2	76.07	1153.3	0.15	11.867	0.07	23.6	NULL	8.08
32	TABLEA2_OOMA_1	1	2S	2	5	27.17	362.02	1.07	5588.24	3.16	89.6	32.44	472.3	0.14	22.358	0.09	24.5	NULL	8.17
33	TABLEA2_OOMA_1	1	3S	3	10	9.77	72.38	0.82	1372.34	4.60	103.6	18.03	237.2	0.12	27.835	0.08	25.5	NULL	8.18
34	TABLEA2_OOMA_1	1	4S	4	50	5.71	22.92	1.86	556.65	5.88	93.3	11.84	119.8	0.16	33.930	0.04	26.5	NULL	8.18
35	TABLEA2_OOMA_1	1	5S	5	100	4.42	19.26	1.88	320.60	6.42	82.9	10.88	100.7	0.10	34.185	0.08	26.3	NULL	8.17
36	TABLEA2_OOMA_1	1	6S	6	200	3.45	16.58	2.53	245.76	6.96	84.2	10.49	100.9	0.12	34.240	0.09	26.4	NULL	8.17

37	TABLEA2_OOMA_2	2	1S	1	1	3.25	4.02	1.45	168.79	7.47	75.4	11.48	84.7	0.12	34.430	0.08	26.4	NULL	8.18
38	TABLEA2_OOMA_2	2	2S	2	5	2.64	1.86	2.62	108.94	6.67	84.4	9.56	89.7	0.15	34.532	0.07	26.3	NULL	8.17
39	TABLEA2_OOMA_2	2	3S	3	10	3.34	12.16	2.04	451.79	4.83	75.9	8.25	112.8	0.14	32.204	0.10	26.2	NULL	8.20
40	TABLEA2_OOMA_2	2	4S	4	50	2.57	4.31	2.50	181.26	6.80	68.0	9.92	75.7	0.14	34.436	0.07	26.3	NULL	8.17
41	TABLEA2_OOMA_2	2	5S	5	100	3.34	3.42	2.80	107.25	7.25	95.4	10.68	100.5	0.09	34.532	0.08	26.5	NULL	8.17
42	TABLEA2_OOMA_2	2	6S	6	200	2.78	0.54	2.34	73.56	7.46	84.8	10.94	87.8	0.10	34.590	0.08	26.4	NULL	8.17

43	TABLEA2_OOMA_3	3	1S	1	1	3.23	1.70	3.46	107.64	6.61	108.8	9.95	115.2	0.16	34.524	0.13	26.9	NULL	8.19
44	TABLEA2_OOMA_3	3	2S	2	5	2.34	1.18	5.78	114.17	6.22	111.4	8.63	120.5	0.13	34.490	0.10	26.6	NULL	8.18
45	TABLEA2_OOMA_3	3	3S	3	10	2.21	5.75	7.19	238.88	8.45	100.4	11.41	115.9	0.14	34.251	0.14	26.6	NULL	8.22
46	TABLEA2_OOMA_3	3	4S	4	50	3.27	2.06	2.84	138.87	6.45	79.5	9.80	85.5	0.10	34.506	0.08	26.4	NULL	8.16
47	TABLEA2_OOMA_3	3	5S	5	100	2.99	1.63	1.66	88.63	6.24	76.5	9.24	79.7	0.12	34.562	0.08	26.5	NULL	8.17
48	TABLEA2_OOMA_3	3	6S	6	200	2.59	0.94	3.71	71.20	7.23	83.3	10.85	88.3	0.12	34.579	0.07	26.4	NULL	8.16

49	TABLEA4_OOMA_1	1	0S	0	0.1	4.13	4.32	3.54	280.00	7.66	217.13	11.79	224.98	0.28	34.77	0.45	27.40	100.00	8.28
50	TABLEA4_OOMA_1	1	5S	5	1	4.70	3.90	2.53	305.56	6.05	187.38	10.76	193.81	0.15	34.77	0.43	27.40	101.00	8.27
51	TABLEA4_OOMA_1	1	10S	10	1	1.26	18.33	BDL	408.37	10.79	194.97	12.05	213.30	0.06	34.48	0.18	26.60	97.00	8.16
52	TABLEA4_OOMA_1	1	25S	25	1	0.57	8.16	BDL	268.39	9.02	208.62	9.59	216.79	0.09	34.66	0.13	26.70	94.00	8.16
53	TABLEA4_OOMA_1	1	50S	50	1	0.46	6.06	BDL	246.57	9.52	191.07	9.98	197.13	0.07	34.70	0.12	26.80	98.00	8.16
54	TABLEA4_OOMA_1	1	100S	100	1	0.57	5.22	BDL	250.46	8.89	175.44	9.46	180.66	0.17	34.69	0.13	26.80	98.00	8.17
55	TABLEA4_OOMA_1	1	500S	500	1	2.06	0.57	BDL	92.36	8.69	213.10	10.76	213.67	0.09	34.89	0.10	26.70	98.00	8.09

56	TABLEA4_OOMA_2	2	0S	0	0.1	1.95	1.01	2.62	124.16	6.87	196.77	8.82	200.39	0.26	34.85	0.16	27.70	99.00	8.19
57	TABLEA4_OOMA_2	2	5S	5	1	1.72	1.01	0.30	121.96	7.36	192.24	9.08	193.55	0.15	34.85	0.25	27.10	101.00	8.20
58	TABLEA4_OOMA_2	2	10S	10	1	1.95	1.44	0.38	121.88	6.61	188.08	8.56	189.91	0.21	34.84	0.11	26.60	89.00	8.08
59	TABLEA4_OOMA_2	2	25S	25	1	2.75	3.15	2.59	164.10	6.84	199.56	9.59	205.31	0.04	34.78	0.12	26.70	88.00	8.14
60	TABLEA4_OOMA_2	2	50S	50	1	2.52	1.47	0.25	125.79	7.85	197.89	10.37	199.61	0.05	34.83	0.13	26.30	86.00	8.16
61	TABLEA4_OOMA_2	2	100S	100	1	2.29	0.64	BDL	110.84	7.04	162.16	9.34	162.79	0.35	34.85	0.11	26.60	87.00	8.17
62	TABLEA4_OOMA_2	2	500S	500	1	2.06	0.65	0.12	83.31	6.49	203.41	8.56	204.18	0.07	34.89	0.09	26.70	84.00	8.16

63	TABLEA4_OOMA_3	3	0S	0	0.1	4.70	1.94	3.73	167.35	5.02	218.35	9.72	224.02	0.80	34.82	0.29	27.90	91.00	8.23
64	TABLEA4_OOMA_3	3	5S	5	1	2.64	1.52	2.09	163.03	7.60	200.81	10.24	204.42	0.16	34.81	0.27	26.50	92.00	8.17
65	TABLEA4_OOMA_3	3	10S	10	1	0.57	1.10	0.35	131.42	8.89	180.17	9.46	181.62	0.07	34.82	0.14	26.60	87.00	8.15
66	TABLEA4_OOMA_3	3	25S	25	1	0.92	0.69	0.26	106.09	8.03	192.13	8.95	193.08	0.05	34.85	0.14	26.80	83.00	8.16
67	TABLEA4_OOMA_3	3	50S	50	1	0.57	0.70	BDL	103.87	7.47	191.07	8.04	191.78	0.24	34.86	0.11	26.40	91.00	8.15
68	TABLEA4_OOMA_3	3	100S	100	1	2.41	0.29	0.38	93.30	6.41	159.47	8.82	160.15	0.17	34.87	0.10	26.70	95.00	8.10
69	TABLEA4_OOMA_3	3	500S	500	1	1.38	0.31	BDL	68.19	6.80	171.30	8.17	171.61	0.06	34.89	0.10	26.30	98.00	8.16
*/

SELECT TableTransect, count(*) FROM OomaRawVarChars
group by TableTransect
order by TableTransect
/*
TABLE2_OOMA_1	10   -- 0,1,2,5,10,15,20,30,50,150 (10 stations) 11/3/2006
TABLE2_OOMA_2	10
TABLE2_OOMA_3	10

TABLEA2_OOMA_1	6    --   1,  5,10,         50,100,200 (6 stations) 10/1990,5/1991,11/1991,3/1992
TABLEA2_OOMA_2	6
TABLEA2_OOMA_3	6

TABLEA4_OOMA_1	7    -- 0,5,10,25,50,100,500 (7 stations) 11/1992
TABLEA4_OOMA_2	7
TABLEA4_OOMA_3	7
*/


/* */
--------------
--------------
--------------
-- clean up the fields, 69, SDollar put text 'BDL' (Below Detection Limit) on certain
-- results which means we need to null out
UPDATE OomaRawVarChars SET PO436396 = NULL WHERE PO436396 = 'BDL'--0
UPDATE OomaRawVarChars SET Nate6393 = NULL WHERE Nate6393 = 'BDL'--0
-- ammonia nitrogen only one with BDL
UPDATE OomaRawVarChars SET Ammn6220 = NULL WHERE Ammn6220 = 'BDL'  -- 8 rows affected

UPDATE OomaRawVarChars SET Sili6360 = NULL WHERE Sili6360 = 'BDL'--0
UPDATE OomaRawVarChars SET DOgP6368 = NULL WHERE DOgP6368 = 'BDL'--0

UPDATE OomaRawVarChars SET DogN6369 = NULL WHERE DogN6369 = 'BDL'--0
UPDATE OomaRawVarChars SET TPho6240 = NULL WHERE TPho6240 = 'BDL'--0
UPDATE OomaRawVarChars SET TDNi6210 = NULL WHERE TDNi6210 = 'BDL'--0
UPDATE OomaRawVarChars SET Turb6260 = NULL WHERE Turb6260 = 'BDL'--0
UPDATE OomaRawVarChars SET Sali6350 = NULL WHERE Sali6350 = 'BDL'--0

UPDATE OomaRawVarChars SET ChlA6250 = NULL WHERE ChlA6250 = 'BDL'--0
UPDATE OomaRawVarChars SET Temp6280 = NULL WHERE Temp6280 = 'BDL'--0
UPDATE OomaRawVarChars SET OxyS6367 = NULL WHERE OxyS6367 = 'BDL'--0
UPDATE OomaRawVarChars SET pHyd6390 = NULL WHERE pHyd6390 = 'BDL'--0

-- special handling for rows with text 'NULL', need to be sql NULL
UPDATE OomaRawVarChars SET OxyS6367 = NULL WHERE OxyS6367 = 'NULL'--18 rows affected
select count(*) from OOMARawVarChars where OxyS6367 is NULL
-- 18
--------------


-------------------------------------[
-------------------------------------
-------------------------------------
-------------------------------------
-- Raw table with proper field types
--   DROP TABLE OOMARaw
CREATE TABLE OomaRaw (
 TableTransect  [varchar](255)  NOT NULL,
 Transect       [int]           NOT NULL,
 StationSCode   [varchar](255)  NOT NULL,
 StationNum     [int]           NOT NULL,
 mShore         [int]           NOT NULL,

 PO436396      [numeric](38, 8) NOT NULL,
 Nate6393      [numeric](38, 8) NOT NULL,
 Ammn6220      [numeric](38, 8)     NULL,-- 8 nulls
 Sili6360      [numeric](38, 8) NOT NULL,
 DOgP6368      [numeric](38, 8) NOT NULL,
 DogN6369      [numeric](38, 8) NOT NULL,
 TPho6240      [numeric](38, 8) NOT NULL,
 TDNi6210      [numeric](38, 8) NOT NULL,
 Turb6260      [numeric](38, 8) NOT NULL,
 Sali6350      [numeric](38, 8) NOT NULL,
 ChlA6250      [numeric](38, 8) NOT NULL,
 Temp6280      [numeric](38, 8) NOT NULL,
 OxyS6367      [numeric](38, 8)     NULL,--table2A has all nulls
 pHyd6390      [numeric](38, 8) NOT NULL,
--
-- location fields to populate
 POINT_Y         [numeric](38,8)     NULL,
 POINT_X         [numeric](38,8)     NULL,
 MyLatLong       [nvarchar](255)     NULL,
 MyLatitude      [nvarchar](255)     NULL,
 MyLabel         [nvarchar](255)     NULL,
 MyLocationLabel [nvarchar](255)     NULL,
 MyCoreName      [nvarchar](255)     NULL,

-- dates will be manually set from EIS document
 MyStartDate     [datetime2](7)      NULL,
 MyEndDate       [datetime2](7)      NULL,

-- for pkStation, pkStation names
 MyAnalyleList	 [nvarchar](255)   NULL,
 MyTransectName  [nvarchar](255)   NULL,
 MyTempDateRange [nvarchar](255)   NULL,
 MyTableId	     [nvarchar](255)   NULL,
 MyTableNum      [nvarchar](255)   NULL,
 MyTableName     [nvarchar](255)   NULL,
 
 -- tracking
 RawUniq         [uniqueidentifier] NOT NULL,
 GeoUniq         [uniqueidentifier]     NULL,
 RawIdentity     [int]              NOT NULL,

PRIMARY KEY (RawIdentity)
)



---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
select * from OOMARawVarChars
--------------------------
--    DELETE FROM OomaRaw
--  INSERT INTO OomaRaw
 SELECT
TableTransect,
CAST(Transect as int),  -- 1,2 or 3
StaCode,                   -- don't actually use this
CAST(StationNum as int),  -- don't actually use this
CAST(DFS as int),   -- mShore convert/rename
-- analytes to numeric
CAST(LTRIM(RTRIM(PO436396)) AS numeric(38,8) ),--1
CAST(LTRIM(RTRIM(Nate6393)) AS numeric(38,8) ),
CAST(LTRIM(RTRIM(Ammn6220)) AS numeric(38,8) ),
CAST(LTRIM(RTRIM(Sili6360)) AS numeric(38,8) ),
CAST(LTRIM(RTRIM(DOgP6368)) AS numeric(38,8) ),--5
CAST(LTRIM(RTRIM(DogN6369)) AS numeric(38,8) ),
CAST(LTRIM(RTRIM(TPho6240)) AS numeric(38,8) ),
CAST(LTRIM(RTRIM(TDNi6210)) AS numeric(38,8) ),
CAST(LTRIM(RTRIM(Turb6260)) AS numeric(38,8) ),
CAST(LTRIM(RTRIM(Sali6350)) AS numeric(38,8) ),--10
CAST(LTRIM(RTRIM(ChlA6250)) AS numeric(38,8) ),
CAST(LTRIM(RTRIM(Temp6280)) AS numeric(38,8) ),
CAST(LTRIM(RTRIM(OxyS6367)) AS numeric(38,8) ),
CAST(LTRIM(RTRIM(pHyd6390)) AS numeric(38,8) ),--14
-- My working fields
NULL,      -- POINT_Y
NULL,      -- POINT_X
NULL,      -- MyLatLong
NULL,      -- MyLatitude
NULL,      -- MyLabel
NULL,      -- MyLocationLabel
NULL,      -- MyCoreName
NULL,NULL, -- Start/End date
NULL,NULL,NULL,NULL,NULL,NULL, -- naming fields
newid(),   -- RawUniq
NULL,      -- GeoUniq
oomIID     -- RawIdentity
FROM OOMARawVarChars
ORDER BY oomIID
-- 69 rows

select * from OOMARaw ORDER BY RawIdentity
select count(*) from OOMARaw 
--69
/*
TableTransect	Transect	StationSCode	StationNum	mShore	PO436396	Nate6393	Ammn6220	Sili6360	DOgP6368	DogN6369	TPho6240	TDNi6210	Turb6260	Sali6350	ChlA6250	Temp6280	OxyS6367	pHyd6390	POINT_Y	POINT_X	MyLatLong	MyLatitude	MyLocationLabel	MyCoreName	MyStartDate	MyEndDate	RawUniq	GeoUniq	RawIdentity
TABLE2_OOMA_1	1	1S	1	0	5.27000000	67.76000000	7.14000000	1231.00000000	8.37000000	91.70000000	13.64000000	166.60000000	0.20000000	32.91700000	0.69000000	26.64000000	106.40000000	8.25000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	0CA58D2E-FA5C-48FC-9717-64F4A62AB2FF	NULL	1
TABLE2_OOMA_1	1	2S	2	1	15.50000000	125.30000000	4.76000000	2105.00000000	11.78000000	111.30000000	27.28000000	241.36000000	0.29000000	31.48200000	0.74000000	26.76000000	105.30000000	8.27000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	4BF476F3-BF85-4170-B916-29F7CF5D8E53	NULL	2
TABLE2_OOMA_1	1	3S	3	2	3.41000000	109.34000000	8.26000000	1850.00000000	9.92000000	96.04000000	13.33000000	213.64000000	0.21000000	31.95200000	0.56000000	26.89000000	107.00000000	8.27000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	68F7639C-DC1B-4C7A-A6DD-433FF2F42A52	NULL	3
TABLE2_OOMA_1	1	4S	4	5	8.37000000	104.72000000	5.60000000	1810.00000000	8.37000000	94.22000000	16.74000000	204.54000000	0.13000000	31.98700000	0.91000000	26.99000000	107.50000000	8.27000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	F4F3E8BB-CDF6-4CBC-B41A-0A51A3EAD049	NULL	4
TABLE2_OOMA_1	1	5S	5	10	2.79000000	94.64000000	5.04000000	1792.00000000	12.71000000	114.80000000	15.50000000	214.48000000	0.20000000	32.04800000	0.94000000	27.00000000	106.40000000	8.26000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	4A268844-DDBD-44BE-8EC4-86A3946CE387	NULL	5
TABLE2_OOMA_1	1	6S	6	15	1.24000000	80.36000000	3.50000000	1451.00000000	8.99000000	99.26000000	10.23000000	183.12000000	0.14000000	32.65500000	0.71000000	27.01000000	104.30000000	8.25000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	02D29924-F88F-4819-B543-1D7490C4E65D	NULL	6
TABLE2_OOMA_1	1	7S	7	20	0.93000000	78.26000000	5.04000000	1324.00000000	8.68000000	87.50000000	9.61000000	170.80000000	0.12000000	32.83900000	0.63000000	27.06000000	104.80000000	8.24000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	B1C11235-B61B-44C2-A38A-9256B7E59D89	NULL	7
TABLE2_OOMA_1	1	8S	8	30	0.93000000	56.00000000	6.16000000	1091.00000000	10.85000000	92.40000000	11.78000000	154.56000000	0.14000000	33.14700000	0.39000000	27.09000000	103.50000000	8.22000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	78C66688-4A4D-45D2-B032-C88C06AFB065	NULL	8
TABLE2_OOMA_1	1	9S	9	50	0.93000000	8.12000000	8.96000000	199.00000000	8.37000000	80.08000000	9.30000000	97.16000000	0.10000000	34.54800000	0.20000000	27.10000000	108.10000000	8.16000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	AB9E9D70-0C10-410C-B9BE-BACF607AA6CC	NULL	9
TABLE2_OOMA_1	1	10S	10	150	0.31000000	3.08000000	12.32000000	70.00000000	8.68000000	96.46000000	8.99000000	111.86000000	0.07000000	34.72700000	0.15000000	27.25000000	105.10000000	8.15000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	8FE81C93-E0D0-4F13-9F2E-1B5955B16370	NULL	10
--
TABLE2_OOMA_2	2	1S	1	0	0.93000000	224.56000000	8.96000000	2061.00000000	8.37000000	118.86000000	9.30000000	352.38000000	0.78000000	28.97700000	1.22000000	26.89000000	105.20000000	8.07000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	CDFE80B9-82CB-454F-B868-F1F6DEC06843	NULL	11
TABLE2_OOMA_2	2	2S	2	1	0.93000000	26.88000000	7.56000000	861.00000000	9.30000000	97.86000000	10.23000000	132.30000000	0.18000000	33.12300000	0.40000000	27.01000000	105.80000000	8.26000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	6BE93246-76B0-4023-BC59-1395D6AC5034	NULL	12
TABLE2_OOMA_2	2	3S	3	2	0.93000000	15.12000000	8.54000000	854.00000000	9.30000000	92.82000000	10.23000000	116.48000000	0.18000000	33.06400000	0.87000000	27.01000000	104.60000000	8.33000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	EC04300B-680E-431E-86F1-5BB4DF3A7299	NULL	13
TABLE2_OOMA_2	2	4S	4	5	0.93000000	25.48000000	6.02000000	858.00000000	8.99000000	104.86000000	9.92000000	136.36000000	0.14000000	33.20500000	0.28000000	27.04000000	106.30000000	8.24000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	C12959B1-54A4-4D0A-9933-CFCE583587C3	NULL	14
TABLE2_OOMA_2	2	5S	5	10	0.93000000	7.56000000	8.68000000	401.00000000	8.68000000	89.18000000	9.61000000	105.42000000	0.11000000	34.08100000	0.34000000	27.10000000	104.50000000	8.23000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	F4A0AE32-ACFC-49F6-9A71-4B5A29AAE4FC	NULL	15
TABLE2_OOMA_2	2	6S	6	15	0.93000000	5.74000000	10.78000000	325.00000000	8.68000000	83.58000000	9.61000000	100.10000000	0.10000000	34.23300000	0.73000000	27.13000000	105.50000000	8.22000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	1E456ECD-1169-48FA-9128-881E8BF05F1E	NULL	16
TABLE2_OOMA_2	2	7S	7	20	0.62000000	2.52000000	10.50000000	249.00000000	8.06000000	91.00000000	8.68000000	104.02000000	0.08000000	34.40800000	0.28000000	27.19000000	106.40000000	8.21000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	2204BC30-3BC2-46E2-8511-D1DA411B9F0D	NULL	17
TABLE2_OOMA_2	2	8S	8	30	0.62000000	2.94000000	10.78000000	205.00000000	8.68000000	99.96000000	9.30000000	113.68000000	0.09000000	34.52100000	0.34000000	27.20000000	101.20000000	8.18000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	94030D8B-11DF-4F23-9780-98BE6D62D86F	NULL	18
TABLE2_OOMA_2	2	9S	9	50	0.62000000	2.66000000	7.28000000	168.00000000	8.37000000	96.60000000	8.99000000	106.54000000	0.08000000	34.60500000	0.38000000	27.23000000	104.50000000	8.18000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	0450EA2D-6E25-4FD5-865C-65D655B48405	NULL	19
TABLE2_OOMA_2	2	10S	10	150	1.55000000	1.96000000	5.18000000	74.00000000	8.99000000	81.34000000	10.54000000	88.48000000	0.08000000	34.72900000	0.12000000	27.24000000	105.50000000	8.16000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	8FEFB05E-E475-476B-AD4D-99874E2DA54E	NULL	20
TABLE2_OOMA_3	3	1S	1	0	19.53000000	642.18000000	14.14000000	10342.00000000	6.51000000	59.36000000	26.04000000	715.68000000	0.13000000	17.14900000	0.44000000	26.54000000	107.40000000	8.18000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	3F9EF2C3-F2FB-4FF4-B93B-31D47BF3F49F	NULL	21
TABLE2_OOMA_3	3	2S	2	1	1.24000000	159.04000000	17.36000000	3051.00000000	9.92000000	147.56000000	11.16000000	323.96000000	0.15000000	28.75100000	0.27000000	26.99000000	105.50000000	8.28000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	35152F4C-E224-47AB-811F-A772C5E2D240	NULL	22
TABLE2_OOMA_3	3	3S	3	2	0.62000000	124.04000000	15.68000000	3024.00000000	10.85000000	130.90000000	11.47000000	270.62000000	0.22000000	29.26500000	2.00000000	27.01000000	104.80000000	8.31000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	F547F916-7ADB-49C0-8EB1-414FAB993C6B	NULL	23
TABLE2_OOMA_3	3	4S	4	5	0.93000000	116.90000000	9.94000000	2838.00000000	9.30000000	106.12000000	10.23000000	232.96000000	0.15000000	29.64200000	0.64000000	27.21000000	106.30000000	8.32000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	B28154E5-2546-4FA0-8B5C-3ED8DEDBB7EB	NULL	24
TABLE2_OOMA_3	3	5S	5	10	1.86000000	118.02000000	9.10000000	2872.00000000	7.75000000	116.62000000	9.61000000	243.74000000	0.13000000	29.61800000	0.46000000	27.14000000	105.30000000	8.32000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	4DE3F736-3256-4CD8-8FB2-F6FB1AB9E59A	NULL	25
TABLE2_OOMA_3	3	6S	6	15	1.24000000	77.70000000	1.96000000	2220.00000000	8.68000000	128.38000000	9.92000000	208.04000000	0.13000000	30.85300000	0.46000000	27.15000000	108.40000000	8.34000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	DC811755-192A-436F-A088-948B8D7B27E0	NULL	26
TABLE2_OOMA_3	3	7S	7	20	1.86000000	25.76000000	0.84000000	926.00000000	8.68000000	101.92000000	10.54000000	128.52000000	0.10000000	33.33200000	0.39000000	27.21000000	103.10000000	8.29000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	FF191020-0EE2-4D07-84F4-9831AA3F5A04	NULL	27
TABLE2_OOMA_3	3	8S	8	30	2.79000000	21.00000000	3.08000000	698.00000000	8.37000000	90.02000000	11.16000000	114.10000000	0.09000000	33.77700000	0.45000000	27.22000000	104.30000000	8.26000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	0BDF19A9-B3CE-4B9C-BE30-368E9C91514C	NULL	28
TABLE2_OOMA_3	3	9S	9	50	11.47000000	4.76000000	0.98000000	185.00000000	0.62000000	105.00000000	12.09000000	110.74000000	0.09000000	34.59500000	0.22000000	27.27000000	108.80000000	8.19000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	0A747344-7F80-4283-BCE8-8EEAEB0C28CC	NULL	29
TABLE2_OOMA_3	3	10S	10	150	1.86000000	6.30000000	1.12000000	189.00000000	7.44000000	105.56000000	9.30000000	112.98000000	0.07000000	34.57500000	0.13000000	27.25000000	105.80000000	8.14000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	9A06BEE1-483D-43AC-9A40-DB63E3FC9BA3	NULL	30
--
TABLEA2_OOMA_1	1	1S	1	1	73.78000000	1076.94000000	0.83000000	14299.72000000	1.58000000	68.20000000	76.07000000	1153.30000000	0.15000000	11.86700000	0.07000000	23.60000000	NULL	8.08000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	847CA150-9CD5-4320-A62C-5FC7CD73AEFF	NULL	31
TABLEA2_OOMA_1	1	2S	2	5	27.17000000	362.02000000	1.07000000	5588.24000000	3.16000000	89.60000000	32.44000000	472.30000000	0.14000000	22.35800000	0.09000000	24.50000000	NULL	8.17000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	958D3217-4CD6-4DB5-A916-031A70C231A1	NULL	32
TABLEA2_OOMA_1	1	3S	3	10	9.77000000	72.38000000	0.82000000	1372.34000000	4.60000000	103.60000000	18.03000000	237.20000000	0.12000000	27.83500000	0.08000000	25.50000000	NULL	8.18000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	A17DF816-A99B-442F-B02C-337820C4AB5C	NULL	33
TABLEA2_OOMA_1	1	4S	4	50	5.71000000	22.92000000	1.86000000	556.65000000	5.88000000	93.30000000	11.84000000	119.80000000	0.16000000	33.93000000	0.04000000	26.50000000	NULL	8.18000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	BEC2A04E-B916-44E8-8D67-DD85EC6098B7	NULL	34
TABLEA2_OOMA_1	1	5S	5	100	4.42000000	19.26000000	1.88000000	320.60000000	6.42000000	82.90000000	10.88000000	100.70000000	0.10000000	34.18500000	0.08000000	26.30000000	NULL	8.17000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	3CA5F42C-2FCB-4921-BF81-86083554766E	NULL	35
TABLEA2_OOMA_1	1	6S	6	200	3.45000000	16.58000000	2.53000000	245.76000000	6.96000000	84.20000000	10.49000000	100.90000000	0.12000000	34.24000000	0.09000000	26.40000000	NULL	8.17000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	25169C25-35C5-497F-BC6C-3FD8447F63CA	NULL	36
--
TABLEA2_OOMA_2	2	1S	1	1	3.25000000	4.02000000	1.45000000	168.79000000	7.47000000	75.40000000	11.48000000	84.70000000	0.12000000	34.43000000	0.08000000	26.40000000	NULL	8.18000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	B646153F-564E-4288-89B1-F88745AE3BC1	NULL	37
TABLEA2_OOMA_2	2	2S	2	5	2.64000000	1.86000000	2.62000000	108.94000000	6.67000000	84.40000000	9.56000000	89.70000000	0.15000000	34.53200000	0.07000000	26.30000000	NULL	8.17000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	3E0DAABC-C9A1-4607-A910-1DE9D0A65CF5	NULL	38
TABLEA2_OOMA_2	2	3S	3	10	3.34000000	12.16000000	2.04000000	451.79000000	4.83000000	75.90000000	8.25000000	112.80000000	0.14000000	32.20400000	0.10000000	26.20000000	NULL	8.20000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	A4F711DA-A91E-4B3E-9749-7EC70DD120F1	NULL	39
TABLEA2_OOMA_2	2	4S	4	50	2.57000000	4.31000000	2.50000000	181.26000000	6.80000000	68.00000000	9.92000000	75.70000000	0.14000000	34.43600000	0.07000000	26.30000000	NULL	8.17000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	A6B25DEA-1023-4D48-9BAE-E62EA22E299A	NULL	40
TABLEA2_OOMA_2	2	5S	5	100	3.34000000	3.42000000	2.80000000	107.25000000	7.25000000	95.40000000	10.68000000	100.50000000	0.09000000	34.53200000	0.08000000	26.50000000	NULL	8.17000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	8F1C584F-8377-4801-9E77-419E2C615164	NULL	41
TABLEA2_OOMA_2	2	6S	6	200	2.78000000	0.54000000	2.34000000	73.56000000	7.46000000	84.80000000	10.94000000	87.80000000	0.10000000	34.59000000	0.08000000	26.40000000	NULL	8.17000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	FA96B5EA-77ED-4ABE-A124-41563CE10623	NULL	42
TABLEA2_OOMA_3	3	1S	1	1	3.23000000	1.70000000	3.46000000	107.64000000	6.61000000	108.80000000	9.95000000	115.20000000	0.16000000	34.52400000	0.13000000	26.90000000	NULL	8.19000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	8E0C6D90-0498-4EF3-83E2-B6502F2E7264	NULL	43
TABLEA2_OOMA_3	3	2S	2	5	2.34000000	1.18000000	5.78000000	114.17000000	6.22000000	111.40000000	8.63000000	120.50000000	0.13000000	34.49000000	0.10000000	26.60000000	NULL	8.18000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	7148573C-869C-4E1C-B52F-028421207110	NULL	44
TABLEA2_OOMA_3	3	3S	3	10	2.21000000	5.75000000	7.19000000	238.88000000	8.45000000	100.40000000	11.41000000	115.90000000	0.14000000	34.25100000	0.14000000	26.60000000	NULL	8.22000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	DB44152D-A6F1-4979-A282-83A74B0B1C52	NULL	45
TABLEA2_OOMA_3	3	4S	4	50	3.27000000	2.06000000	2.84000000	138.87000000	6.45000000	79.50000000	9.80000000	85.50000000	0.10000000	34.50600000	0.08000000	26.40000000	NULL	8.16000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	D2815A23-9362-4C36-A0E9-5C5485237BB7	NULL	46
TABLEA2_OOMA_3	3	5S	5	100	2.99000000	1.63000000	1.66000000	88.63000000	6.24000000	76.50000000	9.24000000	79.70000000	0.12000000	34.56200000	0.08000000	26.50000000	NULL	8.17000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	03220041-2816-42A3-9C6D-5904D0CA72F3	NULL	47
TABLEA2_OOMA_3	3	6S	6	200	2.59000000	0.94000000	3.71000000	71.20000000	7.23000000	83.30000000	10.85000000	88.30000000	0.12000000	34.57900000	0.07000000	26.40000000	NULL	8.16000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	E97EC8A1-53D8-46B8-A581-D9C3660C295C	NULL	48

TABLEA4_OOMA_1	1	0S	0	0	4.13000000	4.32000000	3.54000000	280.00000000	7.66000000	217.13000000	11.79000000	224.98000000	0.28000000	34.77000000	0.45000000	27.40000000	100.00000000	8.28000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	2184356A-3076-4728-B493-CD9A2C791D92	NULL	49
TABLEA4_OOMA_1	1	5S	5	5	4.70000000	3.90000000	2.53000000	305.56000000	6.05000000	187.38000000	10.76000000	193.81000000	0.15000000	34.77000000	0.43000000	27.40000000	101.00000000	8.27000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	E37A54BD-DA7F-4E13-B8E5-3A4FD87DD2DE	NULL	50
TABLEA4_OOMA_1	1	10S	10	10	1.26000000	18.33000000	NULL	408.37000000	10.79000000	194.97000000	12.05000000	213.30000000	0.06000000	34.48000000	0.18000000	26.60000000	97.00000000	8.16000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	DC04A668-04CE-4EF2-9F18-53F1D73813D8	NULL	51
TABLEA4_OOMA_1	1	25S	25	25	0.57000000	8.16000000	NULL	268.39000000	9.02000000	208.62000000	9.59000000	216.79000000	0.09000000	34.66000000	0.13000000	26.70000000	94.00000000	8.16000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	8C1D46CF-250E-45DF-AA98-4C6C51C69576	NULL	52
TABLEA4_OOMA_1	1	50S	50	50	0.46000000	6.06000000	NULL	246.57000000	9.52000000	191.07000000	9.98000000	197.13000000	0.07000000	34.70000000	0.12000000	26.80000000	98.00000000	8.16000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	34207EF2-A5D7-416F-A58B-0360558226D5	NULL	53
TABLEA4_OOMA_1	1	100S	100	100	0.57000000	5.22000000	NULL	250.46000000	8.89000000	175.44000000	9.46000000	180.66000000	0.17000000	34.69000000	0.13000000	26.80000000	98.00000000	8.17000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	61DEF7FE-27B4-446B-92FF-1A637ED90C21	NULL	54
TABLEA4_OOMA_1	1	500S	500	500	2.06000000	0.57000000	NULL	92.36000000	8.69000000	213.10000000	10.76000000	213.67000000	0.09000000	34.89000000	0.10000000	26.70000000	98.00000000	8.09000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	156F1CCE-7451-4C43-8907-E4C7D96EDE0F	NULL	55

TABLEA4_OOMA_2	2	0S	0	0	1.95000000	1.01000000	2.62000000	124.16000000	6.87000000	196.77000000	8.82000000	200.39000000	0.26000000	34.85000000	0.16000000	27.70000000	99.00000000	8.19000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	A38FED4A-EB45-49D4-A9E3-8D06ECF3A4F1	NULL	56
TABLEA4_OOMA_2	2	5S	5	5	1.72000000	1.01000000	0.30000000	121.96000000	7.36000000	192.24000000	9.08000000	193.55000000	0.15000000	34.85000000	0.25000000	27.10000000	101.00000000	8.20000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	6091BD63-61CE-45ED-ABBB-2D654C5F2DC2	NULL	57
TABLEA4_OOMA_2	2	10S	10	10	1.95000000	1.44000000	0.38000000	121.88000000	6.61000000	188.08000000	8.56000000	189.91000000	0.21000000	34.84000000	0.11000000	26.60000000	89.00000000	8.08000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	A260AE41-5D80-40E0-BDB2-71CD519C4E87	NULL	58
TABLEA4_OOMA_2	2	25S	25	25	2.75000000	3.15000000	2.59000000	164.10000000	6.84000000	199.56000000	9.59000000	205.31000000	0.04000000	34.78000000	0.12000000	26.70000000	88.00000000	8.14000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	7EB299D8-2E07-403A-9D6A-C6499E6C0366	NULL	59
TABLEA4_OOMA_2	2	50S	50	50	2.52000000	1.47000000	0.25000000	125.79000000	7.85000000	197.89000000	10.37000000	199.61000000	0.05000000	34.83000000	0.13000000	26.30000000	86.00000000	8.16000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	9FD60C7C-42E4-4049-BF7D-D3C05AEE31F5	NULL	60
TABLEA4_OOMA_2	2	100S	100	100	2.29000000	0.64000000	NULL	110.84000000	7.04000000	162.16000000	9.34000000	162.79000000	0.35000000	34.85000000	0.11000000	26.60000000	87.00000000	8.17000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	7B945A81-EDD1-45C2-B5EC-5B451B4BC710	NULL	61
TABLEA4_OOMA_2	2	500S	500	500	2.06000000	0.65000000	0.12000000	83.31000000	6.49000000	203.41000000	8.56000000	204.18000000	0.07000000	34.89000000	0.09000000	26.70000000	84.00000000	8.16000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	8EBE9E6D-8502-473A-BACD-FA200B6CAFCF	NULL	62

TABLEA4_OOMA_3	3	0S	0	0	4.70000000	1.94000000	3.73000000	167.35000000	5.02000000	218.35000000	9.72000000	224.02000000	0.80000000	34.82000000	0.29000000	27.90000000	91.00000000	8.23000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	E5A09524-136C-44C0-B811-3DFFBD9D31F9	NULL	63
TABLEA4_OOMA_3	3	5S	5	5	2.64000000	1.52000000	2.09000000	163.03000000	7.60000000	200.81000000	10.24000000	204.42000000	0.16000000	34.81000000	0.27000000	26.50000000	92.00000000	8.17000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	ADAB61BA-ECBA-4091-B9B3-530B376DFB50	NULL	64
TABLEA4_OOMA_3	3	10S	10	10	0.57000000	1.10000000	0.35000000	131.42000000	8.89000000	180.17000000	9.46000000	181.62000000	0.07000000	34.82000000	0.14000000	26.60000000	87.00000000	8.15000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	39A21AD6-CB50-4F3D-86D3-F940F040F662	NULL	65
TABLEA4_OOMA_3	3	25S	25	25	0.92000000	0.69000000	0.26000000	106.09000000	8.03000000	192.13000000	8.95000000	193.08000000	0.05000000	34.85000000	0.14000000	26.80000000	83.00000000	8.16000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	E7E9BC68-DCF3-42DC-9931-202B5A8458AD	NULL	66
TABLEA4_OOMA_3	3	50S	50	50	0.57000000	0.70000000	NULL	103.87000000	7.47000000	191.07000000	8.04000000	191.78000000	0.24000000	34.86000000	0.11000000	26.40000000	91.00000000	8.15000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	D34202E9-EBA4-45F0-8081-867EFAFE19AA	NULL	67
TABLEA4_OOMA_3	3	100S	100	100	2.41000000	0.29000000	0.38000000	93.30000000	6.41000000	159.47000000	8.82000000	160.15000000	0.17000000	34.87000000	0.10000000	26.70000000	95.00000000	8.10000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	1F48838D-6AE6-4F01-B203-78FB97DA84AE	NULL	68
TABLEA4_OOMA_3	3	500S	500	500	1.38000000	0.31000000	NULL	68.19000000	6.80000000	171.30000000	8.17000000	171.61000000	0.06000000	34.89000000	0.10000000	26.30000000	98.00000000	8.16000000	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	EB733A20-4F39-4879-92BC-903B67DFD1D7	NULL	69
*/


select distinct(transect) FROM OOMARaw order by Transect
-- 3 rows
/*
transect
1
2
3
*/
select distinct(mShore) FROM OOMARaw order by mShore
-- 14 rows
/*
mShore
0
1
2
5
10
15
20
25
30
50
100
150
200
500
*/


select distinct(mShore),transect FROM OOMARaw order by mShore
-- 42 rows = 3 transects x 14 mShores
/*
mShore	transect
0	1
0	2
0	3
1	1
1	2
1	3
2	1
2	2
2	3
5	1
5	2
5	3
10	1
10	2
10	3
15	1
15	2
15	3
20	1
20	2
20	3
25	1
25	2
25	3
30	1
30	2
30	3
50	1
50	2
50	3
100	1
100	2
100	3
150	1
150	2
150	3
200	1
200	2
200	3
500	1
500	2
500	3
*/


select * from OomaRaw

-- from the specified dates in the respective tables
UPDATE OomaRaw SET MyStartDate='2006-11-03 00:00:01',MyEndDate='2006-11-03 23:00:00'  WHERE TableTransect = 'TABLE2_OOMA_1' 
UPDATE OomaRaw SET MyStartDate='2006-11-03 00:00:02',MyEndDate='2006-11-03 23:00:01'  WHERE TableTransect = 'TABLE2_OOMA_2' 
UPDATE OomaRaw SET MyStartDate='2006-11-03 00:00:03',MyEndDate='2006-11-03 23:00:02'  WHERE TableTransect = 'TABLE2_OOMA_3' 
-- 10 each
UPDATE OomaRaw SET MyTempDateRange='Nov2006ToNov2006', MyTableId = 'Table2Page34', MyTableNum=1, MyTableName='Table2'
 WHERE TableTransect IN('TABLE2_OOMA_1','TABLE2_OOMA_2','TABLE2_OOMA_3' )
-- 30

-- table 2 is the geomean of 4 difference dates (table2 abd tablea4 are just one date)
UPDATE OomaRaw SET MyStartDate='1990-10-01 00:00:01',MyEndDate='1992-03-01 23:00:00'  WHERE TableTransect = 'TABLEA2_OOMA_1' 
UPDATE OomaRaw SET MyStartDate='1990-10-01 00:00:02',MyEndDate='1992-03-01 23:00:01'  WHERE TableTransect = 'TABLEA2_OOMA_2' 
UPDATE OomaRaw SET MyStartDate='1990-10-01 00:00:03',MyEndDate='1992-03-01 23:00:02'  WHERE TableTransect = 'TABLEA2_OOMA_3' 
-- 6 each
UPDATE OomaRaw SET MyTempDateRange='Oct1990May1991Nov1991Mar1992GMean', MyTableId = 'TableA2Page43', MyTableNum=2, MyTableName='TableA2'
 WHERE TableTransect IN('TABLEA2_OOMA_1','TABLEA2_OOMA_2','TABLEA2_OOMA_3' )
-- 18

UPDATE OomaRaw SET MyStartDate='1992-11-01 00:00:01',MyEndDate='1992-11-01 23:00:00'  WHERE TableTransect = 'TABLEA4_OOMA_1' 
UPDATE OomaRaw SET MyStartDate='1992-11-01 00:00:02',MyEndDate='1992-11-01 23:00:01'  WHERE TableTransect = 'TABLEA4_OOMA_2' 
UPDATE OomaRaw SET MyStartDate='1992-11-01 00:00:03',MyEndDate='1992-11-01 23:00:02'  WHERE TableTransect = 'TABLEA4_OOMA_3' 
-- 7 each
UPDATE OomaRaw SET MyTempDateRange='Nov2002ToNov2002', MyTableId = 'TableA4Page45', MyTableNum=3, MyTableName='TableA4'
 WHERE TableTransect IN('TABLEA4_OOMA_1','TABLEA4_OOMA_2','TABLEA4_OOMA_3' )
-- 21

-- by transect assign a name
UPDATE OomaRaw SET MyTransectName = 'Transect1North'
   WHERE TableTransect IN('TABLE2_OOMA_1' ,'TABLEA2_OOMA_1', 'TABLEA4_OOMA_1' )
UPDATE OomaRaw SET MyTransectName = 'Transect2Middle'
   WHERE TableTransect IN('TABLE2_OOMA_2' ,'TABLEA2_OOMA_2', 'TABLEA4_OOMA_2' )
UPDATE OomaRaw SET MyTransectName = 'Transect3South'
   WHERE TableTransect IN('TABLE2_OOMA_3' ,'TABLEA2_OOMA_3', 'TABLEA4_OOMA_3' )
-- 23 each
select * from OomaRaw order by RawIdentity
-- 69

-- all analytes almost all rows - clean and mostly symmetric
UPDATE OomaRaw SET MyAnalyleList = 'TDP6240NO36393Ammn6220Sili6360DOgP6368DogN6369TPho6240TDNi6210Turb6260Sali6350ChlA6250Temp6280OxyS6367pHyd6390'
-- 69
-- OxyS6367 missing TableA2
UPDATE OomaRaw SET MyAnalyleList = 'TDP6240NO36393Sili6360DOgP6368DogN6369TPho6240TDNi6210Turb6260Sali6350ChlA6250Temp6280OxyS6367pHyd6390'
WHERE OxyS6367 IS NULL
-- 18
-- Ammn6220 NULL in 8 rows
UPDATE OomaRaw SET MyAnalyleList = 'TDP6240NO36393Sili6360DOgP6368DogN6369TPho6240TDNi6210Turb6260Sali6350ChlA6250Temp6280OxyS6367pHyd6390'
WHERE Ammn6220 IS NULL
-- 8 rows affected
select * from OomaRaw order by RawIdentity

-----------------------------------------------------
------------------------------------------------------
------------------------------------------------------
------------------------------------------------------
-- Ooma only provided a diagram with transect locations (no GPS coordinates)
-- This table holds by geocodes for all possible locations on all three transects
--   DROP TABLE OomaMyGeocodedLocations
CREATE TABLE OomaMyGeocodedLocations (
   Transect         [int]              NOT NULL,
   mShore           [int]              NOT NULL,
   TableTransect    [nvarchar](255)    NOT NULL,
--
   MyGeoCodePOINT_Y [numeric](38,8)    NOT NULL,
   MyGeoCodePOINT_X [numeric](38,8)    NOT NULL,
--   
   -- to update once above XY are populated
   MyLatLong        [nvarchar](255)        NULL,
   MyLatitude       [nvarchar](255)        NULL,
--
   GeoUniq          [uniqueidentifier] NOT NULL,

PRIMARY KEY (Transect,mShore,TableTransect)
)
--
select * from OomaMyGeocodedLocations order by tabletransect
select count(*) from OomaMyGeocodedLocations group by Transect  order by Transect


-- matches input
-- place my Google MyMaps geocoded locations for sites I have geocoded with Google MyMaps 
--  delete from OOmaMyGeocodedLocations
INSERT INTO OomaMyGeocodedLocations VALUES (1,  0, 'TABLE2_OOMA_1', 19.70835, -156.04829, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (1,  1, 'TABLE2_OOMA_1', 19.70835, -156.04830, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (1,  2, 'TABLE2_OOMA_1', 19.70835, -156.04831, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (1,  5, 'TABLE2_OOMA_1', 19.70835, -156.04834, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (1, 10, 'TABLE2_OOMA_1', 19.70835, -156.04838, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (1, 15, 'TABLE2_OOMA_1', 19.70835, -156.04843, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (1, 20, 'TABLE2_OOMA_1', 19.70835, -156.04848, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (1, 30, 'TABLE2_OOMA_1', 19.70835, -156.04853, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (1, 50, 'TABLE2_OOMA_1', 19.70835, -156.04876, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (1,150, 'TABLE2_OOMA_1', 19.70834, -156.04972, NULL,NULL, newid())
--
INSERT INTO OomaMyGeocodedLocations VALUES (1,  1, 'TABLEA2_OOMA_1', 19.71178, -156.0494, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (1,  5, 'TABLEA2_OOMA_1', 19.71178, -156.0495, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (1, 10, 'TABLEA2_OOMA_1', 19.71178, -156.0495, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (1, 50, 'TABLEA2_OOMA_1', 19.71178, -156.0499, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (1,100, 'TABLEA2_OOMA_1', 19.71178, -156.0503, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (1,200, 'TABLEA2_OOMA_1', 19.71178, -156.0513, NULL,NULL, newid())
--
INSERT INTO OomaMyGeocodedLocations VALUES (1,  0, 'TABLEA4_OOMA_1', 19.70835, -156.04829, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (1,  5, 'TABLEA4_OOMA_1', 19.70835, -156.04834, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (1, 10, 'TABLEA4_OOMA_1', 19.70835, -156.04838, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (1, 25, 'TABLEA4_OOMA_1', 19.70835, -156.04853, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (1, 50, 'TABLEA4_OOMA_1', 19.70835, -156.04876, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (1,100, 'TABLEA4_OOMA_1', 19.70835, -156.04924, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (1,500, 'TABLEA4_OOMA_1', 19.70834, -156.05306, NULL,NULL, newid())
--
INSERT INTO OomaMyGeocodedLocations VALUES (2,  0, 'TABLE2_OOMA_2', 19.70454, -156.04812, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (2,  1, 'TABLE2_OOMA_2', 19.70454, -156.04812, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (2,  2, 'TABLE2_OOMA_2', 19.70454, -156.04812, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (2,  5, 'TABLE2_OOMA_2', 19.70454, -156.04817, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (2, 10, 'TABLE2_OOMA_2', 19.70454, -156.04822, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (2, 15, 'TABLE2_OOMA_2', 19.70454, -156.04822, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (2, 20, 'TABLE2_OOMA_2', 19.70454, -156.04822, NULL,NULL, newid())
--don
INSERT INTO OomaMyGeocodedLocations VALUES (2, 30, 'TABLE2_OOMA_2', 19.70454, -156.04822, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (2, 50, 'TABLE2_OOMA_2', 19.70454, -156.04822, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (2,150, 'TABLE2_OOMA_2', 19.70454, -156.04956, NULL,NULL, newid())
--
INSERT INTO OomaMyGeocodedLocations VALUES (2,  1, 'TABLEA2_OOMA_2', 19.70454, -156.04812, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (2,  5, 'TABLEA2_OOMA_2', 19.70454, -156.04817, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (2, 10, 'TABLEA2_OOMA_2', 19.70454, -156.04822, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (2, 50, 'TABLEA2_OOMA_2', 19.70454, -156.04822, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (2,100, 'TABLEA2_OOMA_2', 19.70454, -156.04822, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (2,200, 'TABLEA2_OOMA_2', 19.70453, -156.05004, NULL,NULL, newid())
--	
INSERT INTO OomaMyGeocodedLocations VALUES (2,  0, 'TABLEA4_OOMA_2', 19.70454, -156.04812, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (2,  5, 'TABLEA4_OOMA_2', 19.70454, -156.04817, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (2, 10, 'TABLEA4_OOMA_2', 19.70454, -156.04822, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (2, 25, 'TABLEA4_OOMA_2', 19.70454, -156.04822, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (2, 50, 'TABLEA4_OOMA_2', 19.70454, -156.04822, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (2,100, 'TABLEA4_OOMA_2', 19.70454, -156.04822, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (2,500, 'TABLEA4_OOMA_2', 19.70454, -156.05289, NULL,NULL, newid())
--
INSERT INTO OomaMyGeocodedLocations VALUES (3,  0, 'TABLE2_OOMA_3', 19.70131, -156.04891, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (3,  1, 'TABLE2_OOMA_3', 19.70131, -156.04891, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (3,  2, 'TABLE2_OOMA_3', 19.70131, -156.04891, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (3,  5, 'TABLE2_OOMA_3', 19.70131, -156.04891, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (3, 10, 'TABLE2_OOMA_3', 19.70131, -156.04891, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (3, 15, 'TABLE2_OOMA_3', 19.70131, -156.04891, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (3, 20, 'TABLE2_OOMA_3', 19.70131, -156.04897, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (3, 30, 'TABLE2_OOMA_3', 19.70131, -156.04906, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (3, 50, 'TABLE2_OOMA_3', 19.70131, -156.04925, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (3,150, 'TABLE2_OOMA_3', 19.70131, -156.05020, NULL,NULL, newid())
--
INSERT INTO OomaMyGeocodedLocations VALUES (3,  1, 'TABLEA2_OOMA_3', 19.70131, -156.04891, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (3,  5, 'TABLEA2_OOMA_3', 19.70131, -156.04891, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (3, 10, 'TABLEA2_OOMA_3', 19.70131, -156.04891, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (3, 50, 'TABLEA2_OOMA_3', 19.70131, -156.04925, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (3,100, 'TABLEA2_OOMA_3', 19.70131, -156.04973, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (3,200, 'TABLEA2_OOMA_3', 19.70131, -156.05069, NULL,NULL, newid())
--
INSERT INTO OomaMyGeocodedLocations VALUES (3,  0, 'TABLEA4_OOMA_3', 19.70131, -156.04891, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (3,  5, 'TABLEA4_OOMA_3', 19.70131, -156.04891, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (3, 10, 'TABLEA4_OOMA_3', 19.70131, -156.04891, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (3, 25, 'TABLEA4_OOMA_3', 19.70131, -156.04901, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (3, 50, 'TABLEA4_OOMA_3', 19.70131, -156.04925, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (3,100, 'TABLEA4_OOMA_3', 19.70131, -156.04973, NULL,NULL, newid())
INSERT INTO OomaMyGeocodedLocations VALUES (3,500, 'TABLEA4_OOMA_3', 19.70131, -156.05353, NULL,NULL, newid())
--	
SELECT COUNT(*) FROM OomaMyGeocodedLocations
--23
SELECT * FROM OomaMyGeocodedLocations
-- 69 good should match Raw table, one geocode per transect,mShore,TransectTable name
--------------------------------------
--------------------------------------
--------------------------------------
--------------------------------------
select * from OomaMyGeocodedLocations

-- have fields in place to make my latitude, round and replace . with _ for filename
UPDATE OomaMyGeocodedLocations SET 
MyLatitude = CAST( REPLACE( str( CAST(MyGeoCodePOINT_Y AS DECIMAL (7,4)),7,4),'.','_') AS varchar)
-- 42 rows affected
select * from OomaMyGeocodedLocations

-- MyLatLong is used for use in Google MyMaps with lines Lat,Long together with comma separator
UPDATE OomaMyGeocodedLocations SET 
MyLatLong  = MyLatitude + ' , ' + str(MyGeoCodePOINT_X, 9, 4)
-- 42 rows affected
select * from OomaMyGeocodedLocations

select COUNT(*) from OomaMyGeocodedLocations
-- 42
select DISTINCT(mshore) from OomaRaw
-- 14 distinct distances
/*
mshore
0
1
2
5
10
15
20
25
30
50
100
150
200
500
*/
select COUNT(DISTINCT(Transect)) from OomaRaw
-- 3
select * from OomaMyGeocodedLocations
/*
Transect	mShore	MyGeoCodePOINT_Y	MyGeoCodePOINT_X	MyLatLong	MyLatitude	GeoUniq
1	0	19.70835000	-156.04829000	19.7083 , -156.0483	19_7084	A1DF33C1-384A-4F5B-BD43-B5D94D9B2A95
1	1	19.70835000	-156.04830000	19.7083 , -156.0483	19_7084	D2A6930D-23F9-4AB9-9866-33914DEDDBD2
1	2	19.70835000	-156.04831000	19.7083 , -156.0483	19_7084	5A0A4BAB-B829-46B3-96B8-008217D6C1F0
1	5	19.70835000	-156.04834000	19.7083 , -156.0483	19_7084	112E74C3-EE4A-49E1-B785-312E2223B13E
1	10	19.70835000	-156.04838000	19.7083 , -156.0484	19_7084	87569173-4068-4A74-A99B-FB54BBA83CAF
1	15	19.70835000	-156.04843000	19.7083 , -156.0484	19_7084	A150437F-95D6-4463-BCC3-4C0910EED8A9
1	20	19.70835000	-156.04848000	19.7083 , -156.0485	19_7084	238C7CF8-4C86-4880-9751-64B7A7686189
1	25	19.70835000	-156.04853000	19.7083 , -156.0485	19_7084	8AEE5E90-DFB9-46FE-8554-40C35324D239
1	30	19.70835000	-156.04853000	19.7083 , -156.0485	19_7084	768A10BC-B3CA-4702-BA64-4DB7798994D3
1	50	19.70835000	-156.04876000	19.7083 , -156.0488	19_7084	98136CDF-21C5-4963-83F8-8AAC5C2BAD5E
1	100	19.70835000	-156.04924000	19.7083 , -156.0492	19_7084	C06EA41C-6766-4E78-B52B-6DD96BFD0085
1	150	19.70834000	-156.04972000	19.7083 , -156.0497	19_7083	434378F3-22C4-47F6-984D-F5658FA19CDA
1	200	19.70835000	-156.05021000	19.7083 , -156.0502	19_7084	B10B7232-EE93-4451-8C3B-1F539D8D483C
1	500	19.70834000	-156.05306000	19.7083 , -156.0531	19_7083	3F4F141F-B4DD-4C61-9FB9-2DB39C7681FD
2	0	19.70454000	-156.04812000	19.7045 , -156.0481	19_7045	68392235-48AA-40E9-BF55-9AB09BB80F69
2	1	19.70454000	-156.04812000	19.7045 , -156.0481	19_7045	C3CB6186-7472-40D6-8DB1-E034D2F72C00
2	2	19.70454000	-156.04812000	19.7045 , -156.0481	19_7045	C5285806-1928-4076-9177-D0673BD2D045
2	5	19.70454000	-156.04817000	19.7045 , -156.0482	19_7045	B8F9F522-051D-4CD3-8E7E-AF9D6E70C776
2	10	19.70454000	-156.04822000	19.7045 , -156.0482	19_7045	E637C306-C4E0-4CD5-AD0F-09BF5A8244F5
2	15	19.70454000	-156.04822000	19.7045 , -156.0482	19_7045	E95152ED-35FB-405D-BA82-A6781DAC7339
2	20	19.70454000	-156.04822000	19.7045 , -156.0482	19_7045	61A44175-210C-4E0C-B263-457C144719F8
2	25	19.70454000	-156.04822000	19.7045 , -156.0482	19_7045	491246BB-48AC-4A65-B842-602700B227BE
2	30	19.70454000	-156.04822000	19.7045 , -156.0482	19_7045	98781047-1D9C-46DE-967C-3C6A8478D7D8
2	50	19.70454000	-156.04822000	19.7045 , -156.0482	19_7045	634EF42D-DDCE-4334-A0A3-B66402D032C6
2	100	19.70454000	-156.04822000	19.7045 , -156.0482	19_7045	D6296B45-B4E8-40B3-8706-413805CED6C2
2	150	19.70454000	-156.04956000	19.7045 , -156.0496	19_7045	1D4393B4-94E9-45D9-9EE0-6585E0A29DCD
2	200	19.70453000	-156.05004000	19.7045 , -156.0500	19_7045	9741A67A-E1B7-4658-8153-7474EADB3A1F
2	500	19.70454000	-156.05289000	19.7045 , -156.0529	19_7045	434467C3-6E75-4F97-9837-96C2630E1DBD
3	0	19.70131000	-156.04891000	19.7013 , -156.0489	19_7013	2C82AE01-24A2-4AE8-B467-5C20DA8229FD
3	1	19.70131000	-156.04891000	19.7013 , -156.0489	19_7013	5BEA2527-E74B-4137-9B47-31E894AE851C
3	2	19.70131000	-156.04891000	19.7013 , -156.0489	19_7013	51FB383C-ABD7-4861-95F5-8963790212EE
3	5	19.70131000	-156.04891000	19.7013 , -156.0489	19_7013	AC0071E6-BE0B-4D72-AFEC-CDAC85B2BD50
3	10	19.70131000	-156.04891000	19.7013 , -156.0489	19_7013	6F42BF67-CB4D-4970-9B2A-FFAC14840819
3	15	19.70131000	-156.04891000	19.7013 , -156.0489	19_7013	DF8E7EE6-1530-46BE-9D1D-A8276F58FEA1
3	20	19.70131000	-156.04897000	19.7013 , -156.0490	19_7013	62B0888C-3585-4FD1-B9F4-722CC32389B9
3	25	19.70131000	-156.04901000	19.7013 , -156.0490	19_7013	F1E605F5-8563-4A27-949D-2BA909AA9971
3	30	19.70131000	-156.04906000	19.7013 , -156.0491	19_7013	850DBC23-267B-4D05-BABA-E209FDDF28AE
3	50	19.70131000	-156.04925000	19.7013 , -156.0493	19_7013	C5467E65-D893-4790-B7C3-33D93098F3D3
3	100	19.70131000	-156.04973000	19.7013 , -156.0497	19_7013	E42B9C04-3BD8-49AF-8346-F112BCCFAA54
3	150	19.70131000	-156.05020000	19.7013 , -156.0502	19_7013	37ABFDBD-D6F8-44FA-BDC6-DDDDDC94D6D5
3	200	19.70131000	-156.05069000	19.7013 , -156.0507	19_7013	197AF28E-1C26-4C45-85D8-7BCB17FB1702
3	500	19.70131000	-156.05353000	19.7013 , -156.0535	19_7013	E144D9B2-AE1D-4058-A14D-883B4DF5AD53
*/




 -- file in what we have prepared in the geocoded locations table
UPDATE OomaRaw SET
MyLatLong  = geo.MyLatLong,
MyLatitude = geo.MyLatitude,
POINT_Y    = geo.MyGeoCodePOINT_Y,
POINT_X    = geo.MyGeoCodePOINT_X,
GeoUniq    = geo.GeoUniq
FROM OomaMyGeocodedLocations geo, OOMARaw raw
WHERE geo.Transect = raw.Transect AND geo.mShore = raw.mShore

-- select MyLatitude,MyLatLong,POINT_Y from OomaRaw
-- 69

UPDATE OomaRaw SET 
MyCoreName = MyLatitude + '_' +
              RIGHT('000' + LTRIM(str(mShore)), 3) + 'm_' +
             'OomaBeach_SJDollar'                   + '_' +
			 'Y' + MyTempDateRange                 + '_' +
			 MyTransectName                        + '_' +
			 MyTableID                             + '_' +
			 'EISMay2008'
FROM OOMARaw raw
select MyCoreName from OomaRaw
 

UPDATE OomaRaw SET 
MyLabel = 'OomaBch ' + MyTransectName + ' ' +  
          RIGHT('000' + LTRIM(str(mShore)), 3) + 
		  'm ' + MyTempDateRange
FROM OOMARaw raw
select * FROM OOMARaw raw



--------------------------------------------------------------------------
--------------------------------------------------------------------------
-- make the dates unique by adding a few seconds
DECLARE @RawUniq uniqueidentifier, @StartDate datetime2, @EndDate datetime2, @RowCount integer=0
DECLARE @cursorInsert CURSOR SET @cursorInsert = CURSOR FOR
   SELECT RawUniq, MyStartDate, MyEndDate FROM OomaRaw
OPEN @cursorInsert
FETCH NEXT FROM @cursorInsert INTO @RawUniq, @StartDate, @EndDate
--
WHILE @@FETCH_STATUS = 0
   BEGIN
   set @RowCount = @RowCount + 1
   UPDATE OomaRaw 
   SET MyStartDate = DATEADD(ss,@RowCount,MyStartDate),MyEndDate = DATEADD(ss,@RowCount,MyEndDate)
   WHERE OomaRaw.RawUniq IN (SELECT @RawUniq FROM OomaRaw)
   FETCH NEXT FROM @cursorInsert INTO @RawUniq, @StartDate, @EndDate
   END
CLOSE @cursorInsert
DEALLOCATE @cursorInsert
--
select MyStartDate,MyEndDate from OomaRaw

--------------------------------------------------------------------------
--------------------------------------------------------------------------
--------------------------------------------------------------------------
--  DROP  TABLE OomaFCStation
CREATE TABLE OomaFCStation (
	--[OBJECTID] [int] NOT NULL,
	--[Shape] [geometry] NULL,
	--[GDB_GEOMATTR_DATA] [varbinary](max) NULL,
	[pkStation] [nvarchar](255) NOT NULL,
	[Label] [nvarchar](255) NOT NULL,
	[TablePage] [nvarchar](255) NULL,
	[fkStation1] [nvarchar](255) NULL,
	[fkStation2] [nvarchar](255) NULL,
	[mShore] [int] NULL,
	[dmStA] [int] NOT NULL,
	[dmStAA] [int] NOT NULL,
	[dmStBott] [int] NULL,
	[dmStClas] [int] NOT NULL,
	[dmAccuracy] [int] NOT NULL,
	[dmStReef] [int] NULL,
	[dmStRule] [int] NOT NULL,
	[dmStType] [int] NOT NULL,
	[fkEPA] [nvarchar](255) NULL,
	[fkUSGS] [nvarchar](255) NULL,
	[Embayment] [nvarchar](255) NULL,
	[VolumeBay] [numeric](38, 8) NULL,
	[CrossArea] [numeric](38, 8) NULL,
	[AttachSt] [int] NULL,
	[HICWBTier] [int] NULL,
	[dmAccu4610] [nvarchar](255) NULL,
	[dmAccu4620] [nvarchar](255) NULL,
	[dmAccu4630] [nvarchar](255) NULL,
	[dmAccu4640] [nvarchar](255) NULL,
	[dmAccu4650] [nvarchar](255) NULL,
	[dmAccu4660] [nvarchar](255) NULL,
	[dmAccu4670] [nvarchar](255) NULL,
	[StartDate]  [datetime2](7) NOT NULL,
	[EndDate]    [datetime2](7) NOT NULL,
	[StFloat1]   [numeric](38, 8) NULL,
	[StFloat2]   [numeric](38, 8) NULL,
	[StDate3]    [datetime2](7) NULL,
	[StDate4]    [datetime2](7) NULL,
	[StLong5]    [int] NULL,
--
	[XField] [numeric](38, 8)    NOT NULL, -- Longtitude
	[YField] [numeric](38, 8)    NOT NULL, -- Latitude
--
	[Rotation]   [int]           NOT NULL,
	[Normalize]  [int]           NOT NULL,
	[Weight]     [int]           NOT NULL,
	[PageQuery]  [int]               NULL,
	[PageQueryS] [nvarchar](255)     NULL,
--
	[GeoUniq] [uniqueidentifier] NOT NULL,
	[StatUniq] [uniqueidentifier] NOT NULL,
	[RawUniq] [uniqueidentifier] NOT NULL,

PRIMARY KEY (pkStation)
) 

 select * from OomaRaw

 -----------
 --  DELETE from OomaFCStation
INSERT INTO OomaFCStation SELECT 
raw.MyCoreName,      -- pkStation
raw.MyLabel,
raw.MyTableId,
raw.StationSCode,    -- fkStation1 stores 4 digit Ooma code 1200-1253, e.g. 1200, 1236, ...
TableTransect,
mShore,
3499,6499,3799,7110, -- not applicable values all
4650,                -- dmAccuracy from Google MyMaps geocoding
8855,7777,           -- not applicable values
700,                 -- Environment Impact Report
NULL,NULL,         
'No',                -- not a embayment
NULL,NULL,
REPLACE(MyLatitude,'_',''),  -- AttachSt is latitude as int number
NULL,NULL,NULL,NULL,NULL,    -- no GPS coordinates supplied, so all these NULL to track geocoding
raw.MyLatLong,               -- dmAccu4650 my Google geocode effort
NULL,NULL,
CAST(raw.MyStartDate as datetime), CAST(raw.MyEndDate as datetime), -- startDate and EndDate are the same for Ooma daily samples
NULL,NULL,NULL,NULL,NULL,
--
POINT_X,POINT_Y,             -- XField, YField
--
ROW_NUMBER() OVER(ORDER BY POINT_Y ASC)%2, -- Rotation
0,                           -- Normalize
0,                           -- Weight
0,NULL,                      -- PageQuery/S
--
--
GeoUniq,                  -- GeoUniq
newid(),                  -- StatUniq is assigned here when making a new record
RawUniq                   -- tracer backwards

FROM OomaRaw raw
ORDER BY RawIdentity 
-- 69
select * from OomaFCStation
-- 69

----------------------------------
/* development
-- make sure we have row level integrity
declare @testguid uniqueidentifier = '8388564A-34C2-4BB5-8AF1-F3D4B91DAFC6'
select * from OomaRaw       where RawUniq  = @testguid
select * from OomaFCStation where RawUniq  = @testguid
-- should be exactly 1 row each...and the same one!...
-- this was last tested 1/25/2018
-- more generally all should match to same 69 total
select COUNT(*) 
from OomaRaw raw,OomaFCStation sta
where raw.RawUniq  = sta.RawUniq
-- 69
*/

-- FCStation complete and many preparations compete, move to insert data from OomaRaw and other tables
------------------------------------------------------------------------------
------------------------------------------------------------------------------
------------------------------------------------------------------------------
------------------------------------------------------------------------------
------------------------------------------------------------------------------
------------------------------------------------------------------------------
-- Now work on the TBSample table
-- the pkStation name pieces are available to include fully formed names

--  DROP TABLE OomaTBSample
CREATE TABLE OomaTBSample (
	--[OBJECTID] [int] NOT NULL,

	[pkSample] [nvarchar](255) NOT NULL,
	[Label] [nvarchar](255) NOT NULL,
	[TablePage] [nvarchar](255) NULL,
	[AlertTrue] [int] NULL,
	[fkIDLoc] [nvarchar](255) NOT NULL,
	[Transect] [int] NULL,
	[mShore] [int] NULL,
	[fkStation] [nvarchar](255) NOT NULL,
	[fkStation2] [nvarchar](255) NULL,
	[fkProject] [nvarchar](255) NOT NULL,
	[fkUnqID] [nvarchar](255) NOT NULL,
	[fkOrg] [nvarchar](255) NOT NULL,
	[dmSample] [int] NOT NULL,
	[StartDate] [datetime2](7) NOT NULL,
	[EndDate] [datetime2](7) NOT NULL,
	[TimeMissg] [nvarchar](255) NULL,
	[Medium] [nvarchar](255) NULL,
	[CompStat] [nvarchar](255) NULL,
	[Comment] [nvarchar](255) NULL,
	[AttachSa] [int] NULL,
	[SaFloat1] [numeric](38, 8) NULL,
	[SaFloat2] [numeric](38, 8) NULL,
	[SaDate3] [datetime2](7) NULL,
	[SaDate4] [datetime2](7) NULL,
	[SaLong5] [int] NULL,
	[Rotation] [int] NOT NULL,
	[Normalize] [int] NOT NULL,
	[Weight] [int] NOT NULL,
	[PageQuery] [int] NOT NULL,
	[PageQueryS] [nvarchar](255) NULL,
	[SampUniq] [uniqueidentifier] NULL,
	[RawUniq] [uniqueidentifier] NULL,

-- working fields
	[AnalyteListForpkStation] [nvarchar](255) NOT NULL,
	[pkStationTEMP]           [nvarchar](255)     NULL,
PRIMARY KEY (pkSample)
)
GO

select * from OomaRaw

--   DELETE FROM OomaTBSample
--  INSERT INTO OomaTBSample
SELECT 
raw.MyCoreName + '_' + raw.MyAnalyleList,
raw.MyLabel,             -- LabelName
raw.MyTableId,           -- 
0,                       -- Alert
'SJDollar',              -- fkIDLoc
raw.Transect,            --
raw.mShore,              --
MyCoreName,              -- MyCoreName
raw.TableTransect,
raw.MyCoreName + '_' + RIGHT('000' + LTRIM(str(mShore)), 3), -- pkStation
newid(),                 -- fkUniqID is the new if generated in this new row creation of the insert
'<<fkOrg>>',             -- fkOrg
1410,                    -- method, in the field
raw.MyStartDate, 
raw.MyEndDate,            -- 
'Yes',                    --  TimeMissg field
NULL,NULL,
NULL,                    -- no Comment yet
REPLACE(raw.MyLatitude,'_',''), -- attach code
NULL,NULL,NULL,NULL,NULL,  -- extra fields
0,0,0,1,NULL,              -- cartography fields
newid(),
raw.RawUniq,             -- important for tracing to save source row id
raw.MyAnalyleList,       -- **GET AnalyteListForpkStation**
NULL
FROM OomaRaw raw
ORDER BY (MyCoreName + '_' + raw.MyAnalyleList)
-- 69 affected

select * from OomaTBSample
-- 
-----------------------
-----------------------


---------------------------------------------------------------------------------
---------------------------------------------------------------------------------
---------------------------------------------------------------------------------
---------------------------------------------------------------------------------
---------------------------------------------------------------------------------
-- populate OomaTBResult

--   DROP TABLE OomaTBResult
CREATE TABLE OomaTBResult (
	--[OBJECTID] [int] NOT NULL,
	[fkSample] [nvarchar](255) NOT NULL,
	[Label] [nvarchar](255) NOT NULL,
	[fkIDLoc] [nvarchar](255) NOT NULL,
	[fkUnqID] [nvarchar](255) NOT NULL,
	[Result] [numeric](38, 8) NOT NULL,
	[Stddev] [numeric](38, 8) NULL,
	[dmRAll] [int] NOT NULL,
	[dmRAMeth] [int] NOT NULL,
	[dmR11546] [int] NOT NULL,
	[dmRAnlyt] [int] NOT NULL,
	[dmRBEACH] [int] NOT NULL,
	[Grade] [nvarchar](255) NULL,
	[Comments] [nvarchar](255) NULL,
	[AttachR] [int] NULL,
	[RFloat1] [numeric](38, 8) NULL,
	[RFloat2] [numeric](38, 8) NULL,
	[RDate3] [datetime2](7) NULL,
	[RDate4] [datetime2](7) NULL,
	[RLong5] [int] NULL,
	[RawUniq] [uniqueidentifier] NULL,
	[ResUniq] [uniqueidentifier] NULL,
	[SampUniq] [uniqueidentifier] NULL,

PRIMARY KEY (fkSample,dmRAll) -- per schema
) 
GO

-- delete from OomaTBResult
--------------------------------------------------------------------------------
 --1 of 14
 INSERT INTO OomaTBResult
SELECT 
samp.pkSample,
'PO436396 - PO43 Phosphate',
samp.fkIDLoc,
samp.fkUnqID,
raw.PO436396,
NULL,
6396,
6451,-- dmMethod
6299,
6396,
6499,
NULL, -- Grade
NULL, --Comments,
NULL, NULL, NULL, NULL, NULL, NULL,  
raw.RawUniq, newid(), 
samp.SampUniq  -- SampUniq 
FROM OomaRaw raw, OomaTBSample samp
WHERE raw.RawUniq = samp.RawUniq and raw.PO436396 IS NOT NULL
ORDER BY raw.RawIdentity
-- 69
--------------------------------------------------------------------------------
--2  
INSERT INTO OomaTBResult
SELECT 
samp.pkSample,
'Nate6393 - NO3',
samp.fkIDLoc,
samp.fkUnqID,
raw.Nate6393,
NULL,
6393,
6451,-- dmMethod
6399,
6393,
6499,
NULL, -- Grade
NULL, --Comments,
NULL, NULL, NULL, NULL, NULL, NULL,  
raw.RawUniq, newid(), 
samp.SampUniq  -- SampUniq 
FROM OomaRaw raw, OomaTBSample samp
WHERE raw.RawUniq = samp.RawUniq and raw.Nate6393 IS NOT NULL
ORDER BY raw.RawIdentity
-- 69
--------------------------------------------------------------------------------
--3  
INSERT INTO OomaTBResult
SELECT 
samp.pkSample,
'Ammn6220 - Ammonia Nitrogen',
samp.fkIDLoc,
samp.fkUnqID,
raw.Ammn6220,
NULL,
6220,
6451,-- dmMethod
6220,
6399,
6499,
NULL, -- Grade
NULL, --Comments,
NULL, NULL, NULL, NULL, NULL, NULL,  
raw.RawUniq, newid(), 
samp.SampUniq  -- SampUniq 
FROM OomaRaw raw, OomaTBSample samp
WHERE raw.RawUniq = samp.RawUniq and raw.Ammn6220 IS NOT NULL
ORDER BY raw.RawIdentity
-- 61 (8 NULLs ok)
select sum(Ammn6220) FROM OomaRaw raw
WHERE raw.Ammn6220 IS NOT NULL
select sum(Result) FROM OomaTBResult
WHERE dmRall = 6220
-- 291.78000000 both
--------------------------------------------------------------------------------
--4  
INSERT INTO OomaTBResult
SELECT 
samp.pkSample,
'Sili6360 - Silicates',
samp.fkIDLoc,
samp.fkUnqID,
raw.Sili6360,
NULL,
6360,
6451,-- dmMethod
6299,
6360,
6499,
NULL, -- Grade
NULL, --Comments,
NULL, NULL, NULL, NULL, NULL, NULL,  
raw.RawUniq, newid(), 
samp.SampUniq  -- SampUniq 
FROM OomaRaw raw, OomaTBSample samp
WHERE raw.RawUniq = samp.RawUniq and raw.Sili6360 IS NOT NULL
ORDER BY raw.RawIdentity
-- 69
--------------------------------------------------------------------------------
--5 
INSERT INTO OomaTBResult
SELECT 
samp.pkSample,
'DOgP6368 - Dissolved Organic Phosphorus',
samp.fkIDLoc,
samp.fkUnqID,
raw.DOgP6368,
NULL,
6368,
6451,-- dmMethod
6299,
6368,
6499,
NULL, -- Grade
NULL, --Comments,
NULL, NULL, NULL, NULL, NULL, NULL,  
raw.RawUniq, newid(), 
samp.SampUniq  -- SampUniq 
FROM OomaRaw raw, OomaTBSample samp
WHERE raw.RawUniq = samp.RawUniq and raw.DOgP6368 IS NOT NULL
ORDER BY raw.RawIdentity
-- 69
--------------------------------------------------------------------------------
--6 
INSERT INTO OomaTBResult
SELECT 
samp.pkSample,
'DOgN6369 - Dissolved Organic Nitrogen',
samp.fkIDLoc,
samp.fkUnqID,
raw.DogN6369,
NULL,
6369,
6451,-- dmMethod
6299,
6369,
6499,
NULL, -- Grade
NULL, --Comments,
NULL, NULL, NULL, NULL, NULL, NULL,  
raw.RawUniq, newid(), 
samp.SampUniq  -- SampUniq 
FROM OomaRaw raw, OomaTBSample samp
WHERE raw.RawUniq = samp.RawUniq and raw.DOgN6369 IS NOT NULL
ORDER BY raw.RawIdentity
-- 69
 --------------------------------------------------------------------------------
--7  
INSERT INTO OomaTBResult
SELECT 
samp.pkSample,
'TPho6240 - Total Phosphorus',
samp.fkIDLoc,
samp.fkUnqID,
raw.TPho6240,
NULL,
6240,
6451,-- dmMethod
6240,
6399,
6499,
NULL, -- Grade
NULL, --Comments,
NULL, NULL, NULL, NULL, NULL, NULL,  
raw.RawUniq, newid(), 
samp.SampUniq  -- SampUniq 
FROM OomaRaw raw, OomaTBSample samp
WHERE raw.RawUniq = samp.RawUniq and raw.TPho6240 IS NOT NULL
ORDER BY raw.RawIdentity
-- 69
 --------------------------------------------------------------------------------
--8  
INSERT INTO OomaTBResult
SELECT 
samp.pkSample,
'TDNi6210 - Total Nitrogen',
samp.fkIDLoc,
samp.fkUnqID,
raw.TDNi6210,
NULL,
6210,
6451,-- dmMethod
6210,
6399,
6499,
NULL, -- Grade
NULL, --Comments,
NULL, NULL, NULL, NULL, NULL, NULL,  
raw.RawUniq, newid(), 
samp.SampUniq  -- SampUniq 
FROM OomaRaw raw, OomaTBSample samp
WHERE raw.RawUniq = samp.RawUniq and raw.TDNi6210 IS NOT NULL
ORDER BY raw.RawIdentity
-- 69
--------------------------------------------------------------------------------
--9  
INSERT INTO OomaTBResult
SELECT 
samp.pkSample,
'Turb6260 - Turbidity',
samp.fkIDLoc,
samp.fkUnqID,
raw.Turb6260,
NULL,
6260,
6451,-- dmMethod
6260,
6399,
6499,
NULL, -- Grade
NULL, --Comments,
NULL, NULL, NULL, NULL, NULL, NULL,  
raw.RawUniq, newid(), 
samp.SampUniq  -- SampUniq 
FROM OomaRaw raw, OomaTBSample samp
WHERE raw.RawUniq = samp.RawUniq and raw.Turb6260 IS NOT NULL
ORDER BY raw.RawIdentity
-- 69
--------------------------------------------------------------------------------
--10  
INSERT INTO OomaTBResult
SELECT 
samp.pkSample,
'Sali6350 - Salinity',
samp.fkIDLoc,
samp.fkUnqID,
raw.Sali6350,
NULL,
6350,
6451,-- dmMethod
6350,
6399,
6499,
NULL, -- Grade
NULL, --Comments,
NULL, NULL, NULL, NULL, NULL, NULL,  
raw.RawUniq, newid(), 
samp.SampUniq  -- SampUniq 
FROM OomaRaw raw, OomaTBSample samp
WHERE raw.RawUniq = samp.RawUniq and raw.Sali6350 IS NOT NULL
ORDER BY raw.RawIdentity
-- 69
 --------------------------------------------------------------------------------
--11 
INSERT INTO OomaTBResult
SELECT 
samp.pkSample,
'ChlA6250 - Chlorophyll a',
samp.fkIDLoc,
samp.fkUnqID,
raw.ChlA6250,
NULL,
6250,
6451,-- dmMethod
6299,
6399,
6420,
NULL, -- Grade
NULL, --Comments,
NULL, NULL, NULL, NULL, NULL, NULL,  
raw.RawUniq, newid(), 
samp.SampUniq  -- SampUniq 
FROM OomaRaw raw, OomaTBSample samp
WHERE raw.RawUniq = samp.RawUniq and raw.ChlA6250 IS NOT NULL
ORDER BY raw.RawIdentity
-- 69
 --------------------------------------------------------------------------------
--12 
INSERT INTO OomaTBResult
SELECT 
samp.pkSample,
'Temp6280 - Temperature C',
samp.fkIDLoc,
samp.fkUnqID,
raw.Temp6280,
NULL,
6280,
6451,-- dmMethod
6280,
6399,
6499,
NULL, -- Grade
NULL, --Comments,
NULL, NULL, NULL, NULL, NULL, NULL,  
raw.RawUniq, newid(), 
samp.SampUniq  -- SampUniq 
FROM OomaRaw raw, OomaTBSample samp
WHERE raw.RawUniq = samp.RawUniq and raw.Temp6280 IS NOT NULL
ORDER BY raw.RawIdentity
-- 69
 --------------------------------------------------------------------------------
--13 
INSERT INTO OomaTBResult
SELECT 
samp.pkSample,
'OxyS6367 - O2 Saturation',
samp.fkIDLoc,
samp.fkUnqID,
raw.OxyS6367,
NULL,
6367,
6451,-- dmMethod
6299,
6367,
6499,
NULL, -- Grade
NULL, --Comments,
NULL, NULL, NULL, NULL, NULL, NULL,  
raw.RawUniq, newid(), 
samp.SampUniq  -- SampUniq 
FROM OomaRaw raw, OomaTBSample samp
WHERE raw.RawUniq = samp.RawUniq and raw.OxyS6367 IS NOT NULL
ORDER BY raw.RawIdentity
-- 51 -18 nulls ok
 --------------------------------------------------------------------------------
--14  
INSERT INTO OomaTBResult
SELECT 
samp.pkSample,
'pHyd6390 - pH',
samp.fkIDLoc,
samp.fkUnqID,
raw.pHyd6390,
NULL,
6390,
6451,-- dmMethod
6299,
6390,
6499,
NULL, -- Grade
NULL, --Comments,
NULL, NULL, NULL, NULL, NULL, NULL,  
raw.RawUniq, newid(), 
samp.SampUniq  -- SampUniq 
FROM OomaRaw raw, OomaTBSample samp
WHERE raw.RawUniq = samp.RawUniq and raw.pHyd6390 IS NOT NULL
ORDER BY raw.RawIdentity
-- 69


SELECT COUNT(*) FROM OomaTBResult
-- 940 rows
SELECT * FROM OomaTBResult
-- 940


-- V1 thesis maps displays
SELECT Count(*) as 'TBResult Count' FROM OomaTBResult
SELECT Label, Count(dmRAll) as 'TBResult rows' FROM OomaTBResult GROUP by Label, dmRAll ORDER by 2 DESC
--------------------------------------------------------------------------------


-- V2 thesis maps displays
SELECT '''O''oma Oct1990&May1991&Nov1991&Mar1992 GeoMean' as 'S.J.Dollar', Count(*) as 'TBResult #rows' FROM OomaTBResult WHERE fkSample LIKE '%TableA2Page43%'
SELECT Label, Count(dmRAll) as '#rows', round(exp(avg(log(Result))),3) as '~gmean',round(stdev(Result),2) as 'stdev',cast(min(Result) as decimal (10,2)) as 'min',cast(max(Result) as decimal (10,2)) as 'max' FROM OomaTBResult 
WHERE Result<>0 AND fkSample LIKE '%TableA2Page43%' GROUP by Label, dmRAll ORDER by Label

SELECT '''O''oma November 1,2002' as 'S.J.Dollar', Count(*) as 'TBResult #rows' FROM OomaTBResult WHERE fkSample LIKE '%TableA4Page45%';
SELECT Label, Count(dmRAll) as '#rows', round(exp(avg(log(Result))),3) as '~gmean',round(stdev(Result),2) as 'stdev',cast(min(Result) as decimal (10,2)) as 'min',cast(max(Result) as decimal (10,2)) as 'max' FROM OomaTBResult  WHERE Result<>0 AND fkSample LIKE '%TableA4Page45%' GROUP by Label, dmRAll ORDER by Label

SELECT '''O''oma November 1,2006' as 'S.J.Dollar', Count(*) as 'TBResult #rows' FROM OomaTBResult WHERE fkSample LIKE '%Table2Page34%';
SELECT Label, Count(dmRAll) as '#rows', round(exp(avg(log(Result))),3) as '~gmean',round(stdev(Result),2) as 'stdev',cast(min(Result) as decimal (10,2)) as 'min',cast(max(Result) as decimal (10,2)) as 'max' FROM OomaTBResult WHERE Result<>0 AND fkSample LIKE '%Table2Page34%' GROUP by Label, dmRAll ORDER by Label






-------------------------------------------------------
/* sanity check
select * from OomaTBResult
select * from OomaTBSample
-- randommly choose RawUniq
declare @testguid uniqueidentifier = 'E96C789A-0E4A-4369-A676-FC379F6AE5D0'   -- TBSample 87
--declare @testguid uniqueidentifier = '68A942AD-7B00-48D1-87F0-B1F0C52FF67C' -- TBResults 314
select * 
from OomaTBSample samp, OomaTBResult res
WHERE 
samp.pkStation = res.fkSample 
and 
samp.RawUniq = @testguid
*/

SELECT 
SUM(PO436396) +
SUM(Nate6393) +
SUM(Ammn6220) +
SUM(Sili6360) +
SUM(DOgP6368) +
SUM(DogN6369) +
SUM(TPho6240) +
SUM(TDNi6210) +
SUM(Turb6260) +
SUM(Sali6350) +
SUM(ChlA6250) +
SUM(Temp6280) +
SUM(OxyS6367) +
SUM(pHyd6390) FROM OomaRaw
-- 110556.21600000

SELECT SUM(Result) From OomaTBResult
-- 110556.21600000

select * from OomaTBSample
where fkUnqID = 
'0B82EEE5-D31D-45C6-ACF8-F2D2D51DE695'

select * from OomaTBResult
where fkUnqID = 
'0B82EEE5-D31D-45C6-ACF8-F2D2D51DE695'

select * from OomaFCStation
where pkStation = 
'19_7013_000m_OomaBeach_SDollar_YNov2002ToNov2002_Transect3South_TableA4Page45_EISMay2008'

select * from OomaTBSample
where fkStation = 
'19_7013_000m_OomaBeach_SDollar_YNov2002ToNov2002_Transect3South_TableA4Page45_EISMay2008'



